<!doctype html><html lang=ja-jp>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="データ型 スカラー … 数値、文字列、バイナリ、ブール、null ドキュメント … リスト、マップ セット … 同一型のスカラー型を複数格納できるデータ型。文">
<meta name=generator content="Hugo 0.88.1">
<title>DynamoDB | Memo.Namo</title>
<meta name=robots content="noindex, nofollow">
<link rel=stylesheet href=/style/main.css>
</head>
<body>
<div class=flexbox>
<div>
<header id=site-header class=toplevel-container>
<h1><a href=/>Memo.Namo</a></h1>
<nav>
<ul class=horizontal-menu>
<li class=horizontal-menu-item><a href=/about/>About</a></li>
<li class=horizontal-menu-item><a href=/knowledge/>Knowledge</a></li>
</ul>
</nav>
</header>
<main id=site-main class=toplevel-container>
<article class="content-container content-grid">
<header class=content-grid-header>
<div>
<a class=nav-category href=/knowledge/aws/>AWS</a>
<h1 class=content-grid-title>DynamoDB</h1>
</div>
<p class=content-grid-desc>
<span>公開日: 2020-08-24</span>
<span>更新日: 2020-08-24</span>
</p>
</header>
<aside class=content-grid-side>
<div class=nav-sticky>
<h2>目次</h2>
<nav id=TableOfContents>
<ul>
<li><a href=#データ型>データ型</a></li>
<li><a href=#テーブル操作>テーブル操作</a></li>
<li><a href=#データ操作>データ操作</a></li>
</ul>
</nav>
<nav class=nav-tag>
<h2>タグ</h2>
<ul class=tag-container>
<li class="tag-item tag-item-active">
<a href=/tags/aws/>AWS</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/box/>Box</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/hugo/>Hugo</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/nvidia/>Nvidia</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/openssl/>OpenSSL</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/tableau/>Tableau</a>
</li>
</ul>
</nav>
</div>
</aside>
<section class="md-content content-grid-main"><h1 id=データ型>データ型</h1>
<ul>
<li>スカラー … 数値、文字列、バイナリ、ブール、null</li>
<li>ドキュメント … リスト、マップ</li>
<li>セット … 同一型のスカラー型を複数格納できるデータ型。文字セット、数値セット、バイナリセットの3種類がある</li>
</ul>
<h1 id=テーブル操作>テーブル操作</h1>
<ul>
<li>テーブル</li>
<li>項目</li>
</ul>
<h1 id=データ操作>データ操作</h1>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>boto3</span>
<span class=kn>import</span> <span class=nn>datetime</span>

<span class=n>dynamodb</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>resource</span><span class=p>(</span><span class=s2>&#34;dynamodb&#34;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=s2>&#34;ap-northeast-1&#34;</span><span class=p>)</span>
<span class=n>table</span> <span class=o>=</span> <span class=n>dynamodb</span><span class=o>.</span><span class=n>Table</span><span class=p>(</span><span class=s2>&#34;Books&#34;</span><span class=p>)</span>

<span class=c1># アイテム登録</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>put_item</span><span class=p>(</span><span class=n>Item</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span>
    <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span><span class=p>,</span>
    <span class=s2>&#34;Num&#34;</span><span class=p>:</span> <span class=mi>123</span><span class=p>,</span>
    <span class=s2>&#34;Obj&#34;</span><span class=p>:</span> <span class=nb>dict</span><span class=p>(),</span>
    <span class=s2>&#34;Lst&#34;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(),</span>
    <span class=s2>&#34;Set&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=s2>&#34;set_1&#34;</span><span class=p>,</span> <span class=s2>&#34;set_2&#34;</span> <span class=p>},</span>
<span class=p>})</span>

<span class=c1># アイテム取得</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>get_item</span><span class=p>(</span><span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>})</span>
<span class=n>item_meta</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s2>&#34;ResponseMetadata&#34;</span><span class=p>]</span>
<span class=n>item_payload</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s2>&#34;Item&#34;</span><span class=p>]</span>
<span class=n>item_payload_author</span> <span class=o>=</span> <span class=n>item_payload</span><span class=p>[</span><span class=s2>&#34;Author&#34;</span><span class=p>]</span>
<span class=n>item_payload_title</span> <span class=o>=</span> <span class=n>item_payload</span><span class=p>[</span><span class=s2>&#34;Title&#34;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Author: </span><span class=si>{</span><span class=n>item_payload_author</span><span class=si>}</span><span class=s2>, Title: </span><span class=si>{</span><span class=n>item_payload_title</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>

<span class=c1># アイテム更新 (代入)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>update_item</span><span class=p>(</span>
    <span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>},</span>
    <span class=n>UpdateExpression</span> <span class=o>=</span> <span class=s2>&#34;set #key1 = :val1, Obj.item1 = :val2, Obj.item2 = :val3, Lst[0] = :val4&#34;</span><span class=p>,</span>
    <span class=n>ExpressionAttributeNames</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;#key1&#34;</span><span class=p>:</span> <span class=s2>&#34;nyao&#34;</span><span class=p>,</span>
    <span class=p>},</span>
    <span class=n>ExpressionAttributeValues</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;:val1&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&#34;%Y-%m-</span><span class=si>%d</span><span class=s2> %H:%M:%S&#34;</span><span class=p>),</span>
        <span class=s2>&#34;:val2&#34;</span><span class=p>:</span> <span class=s2>&#34;obj_text_1&#34;</span><span class=p>,</span>
        <span class=s2>&#34;:val3&#34;</span><span class=p>:</span> <span class=s2>&#34;obj_text_2&#34;</span><span class=p>,</span>
        <span class=s2>&#34;:val4&#34;</span><span class=p>:</span> <span class=mi>123</span><span class=p>,</span>
    <span class=p>}</span>
<span class=p>)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>get_item</span><span class=p>(</span><span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>

<span class=c1># アイテム更新 (リスト追加)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>update_item</span><span class=p>(</span>
    <span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>},</span>
    <span class=n>UpdateExpression</span> <span class=o>=</span> <span class=s2>&#34;set Lst = list_append(Lst, :val3)&#34;</span><span class=p>,</span>
    <span class=n>ExpressionAttributeValues</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;:val3&#34;</span><span class=p>:</span> <span class=p>[</span><span class=mi>456</span><span class=p>,</span> <span class=mi>789</span><span class=p>],</span>
    <span class=p>}</span>
<span class=p>)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>get_item</span><span class=p>(</span><span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>

<span class=c1># アイテム更新 (要素削除)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>update_item</span><span class=p>(</span>
    <span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>},</span>
    <span class=n>UpdateExpression</span> <span class=o>=</span> <span class=s2>&#34;remove Obj.item1, Lst[2]&#34;</span>
<span class=p>)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>get_item</span><span class=p>(</span><span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>

<span class=c1># アイテム更新 (セット追加)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>update_item</span><span class=p>(</span>
    <span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>},</span>
    <span class=n>UpdateExpression</span> <span class=o>=</span> <span class=s2>&#34;add #key1 :val1&#34;</span><span class=p>,</span>
    <span class=n>ExpressionAttributeNames</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;#key1&#34;</span><span class=p>:</span> <span class=s2>&#34;Set&#34;</span><span class=p>,</span>
    <span class=p>},</span>
    <span class=n>ExpressionAttributeValues</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;:val1&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=s2>&#34;four&#34;</span><span class=p>,</span> <span class=s2>&#34;five&#34;</span> <span class=p>}</span>
    <span class=p>}</span>
<span class=p>)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>get_item</span><span class=p>(</span><span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>

<span class=c1># アイテム更新 (セット削除)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>update_item</span><span class=p>(</span>
    <span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>},</span>
    <span class=n>UpdateExpression</span> <span class=o>=</span> <span class=s2>&#34;delete #key1 :val1&#34;</span><span class=p>,</span>
    <span class=n>ExpressionAttributeNames</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;#key1&#34;</span><span class=p>:</span> <span class=s2>&#34;Set&#34;</span><span class=p>,</span>
    <span class=p>},</span>
    <span class=n>ExpressionAttributeValues</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;:val1&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=s2>&#34;four&#34;</span> <span class=p>},</span>
    <span class=p>}</span>
<span class=p>)</span>
<span class=n>item</span> <span class=o>=</span> <span class=n>table</span><span class=o>.</span><span class=n>get_item</span><span class=p>(</span><span class=n>Key</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;athr_1&#34;</span><span class=p>,</span> <span class=s2>&#34;Title&#34;</span><span class=p>:</span> <span class=s2>&#34;ttl_1&#34;</span> <span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</code></pre></div></section>
</article>
</main>
</div>
<div>
<footer id=site-footer class=toplevel-container>
<p>このサイトでは <a href=https://icons8.jp/>icons8</a> の素材を使用しています。</p>
<p>&copy; 2021 namoshika, All rights reserved</p>
</footer>
</div>
</div>
</body>
</html>