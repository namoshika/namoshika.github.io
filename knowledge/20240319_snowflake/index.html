<!doctype html><html lang=ja-jp><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="管理ツール
SnowSQL が提供されている。
# ログイン
$ snowsql -a {アカウント名} -u {ユーザ名}
Password: ...

# ログインすると SQL を実行できる
SHOW DATABASES;
...
基本的なクエリ
よくある構文が使用可能。
データベース操作
-- DB一覧
SHOW DATABASES;

-- DBを作成
CREATE DATABASE HELLO_SNOWFLAKE;

-- DBを選択
USE DATABASE HELLO_SNOWFLAKE;

-- DBを削除
-- DROP DATABASE HELLO_SNOWFLAKE;
スキーマ操作"><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta name=generator content="Hugo 0.136.2"><title>Snowflake を使ってみる | Memo.Namo</title>
<meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/style/main.css></head><body><div class=flexbox><div><header id=site-header class=toplevel-container><h1><a href=/>Memo.Namo</a></h1><nav><ul class=horizontal-menu><li class=horizontal-menu-item><a href=/about/>About</a></li><li class=horizontal-menu-item><a href=/knowledge/>Knowledge</a></li></ul></nav></header><main id=site-main class=toplevel-container><article class="content-container content-grid"><header class=content-grid-header><div><h1 class=content-grid-title>Snowflake を使ってみる</h1></div><p class=content-grid-desc><span>公開日: 2024-03-19</span>
<span>更新日: 2024-07-14</span></p></header><aside class=content-grid-side><div class=nav-sticky><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#管理ツール>管理ツール</a></li><li><a href=#基本的なクエリ>基本的なクエリ</a></li><li><a href=#バルクロード>バルクロード</a><ul><li><a href=#内部ステージ経由>内部ステージ経由</a></li><li><a href=#外部ステージ経由-s3>外部ステージ経由 (S3)</a></li></ul></li><li><a href=#外部テーブル>外部テーブル</a></li><li><a href=#ドライバー>ドライバー</a><ul><li><a href=#python>Python</a></li></ul></li></ul></nav><nav class=nav-tag><h2>タグ</h2><ul class=tag-container><li class="tag-item tag-item-inactive"><a href=/tags/auth/>Auth</a></li><li class="tag-item tag-item-inactive"><a href=/tags/businessman/>BusinessMan</a></li><li class="tag-item tag-item-active"><a href=/tags/database/>Database</a></li><li class="tag-item tag-item-inactive"><a href=/tags/dataengineering/>DataEngineering</a></li><li class="tag-item tag-item-inactive"><a href=/tags/datavisualization/>DataVisualization</a></li><li class="tag-item tag-item-inactive"><a href=/tags/devops/>DevOps</a></li><li class="tag-item tag-item-inactive"><a href=/tags/iac/>IaC</a></li><li class="tag-item tag-item-inactive"><a href=/tags/infrastructure/>Infrastructure</a></li></ul></nav></div></aside><section class="md-content content-grid-main"><h1 id=管理ツール>管理ツール</h1><p><a href=https://docs.snowflake.com/ja/user-guide/snowsql-install-config>SnowSQL</a> が提供されている。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ログイン</span>
</span></span><span class=line><span class=cl>$ snowsql -a <span class=o>{</span>アカウント名<span class=o>}</span> -u <span class=o>{</span>ユーザ名<span class=o>}</span>
</span></span><span class=line><span class=cl>Password: ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ログインすると SQL を実行できる</span>
</span></span><span class=line><span class=cl>SHOW DATABASES<span class=p>;</span>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><h1 id=基本的なクエリ>基本的なクエリ</h1><p>よくある構文が使用可能。</p><p>データベース操作</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- DB一覧
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=n>DATABASES</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- DBを作成
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- DBを選択
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>USE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- DBを削除
</span></span></span><span class=line><span class=cl><span class=c1>-- DROP DATABASE HELLO_SNOWFLAKE;
</span></span></span></code></pre></div><p>スキーマ操作</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Schema一覧
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=n>SCHEMAS</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Schemaを作成
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>SCHEMA</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Schemaを選択
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>USE</span><span class=w> </span><span class=k>SCHEMA</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Schemaを削除
</span></span></span><span class=line><span class=cl><span class=c1>-- DROP SCHEMA HELLO_SNOWFLAKE.SAMPLE_SCHEMA;
</span></span></span></code></pre></div><p>テーブル操作</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Table一覧
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=n>TABLES</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Tableを作成
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>SAMPLE_TBL</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;ymd&#34;</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>10</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;area_1&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;area_2&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;天気概況（昼：06時～18時）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;天気概況（昼：06時～18時）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;天気概況（昼：06時～18時）計測値&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;平均気温（℃）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;平均気温（℃）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;平均気温（℃）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最低気温（℃）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最低気温（℃）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最低気温（℃）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最深積雪（cm）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最深積雪（cm）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最深積雪（cm）現象なし情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最深積雪（cm）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最高気温（℃）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最高気温（℃）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最高気温（℃）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;降水量の合計（mm）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;降水量の合計（mm）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;降水量の合計（mm）現象なし情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;降水量の合計（mm）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Tableを削除
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>SAMPLE_TBL</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>インサートクエリ</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>SAMPLE_TBL</span><span class=w> </span><span class=k>VALUES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>(</span><span class=s1>&#39;2019/01/01&#39;</span><span class=p>,</span><span class=s1>&#39;石狩&#39;</span><span class=p>,</span><span class=s1>&#39;札幌&#39;</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;雪時々曇&#39;</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>.</span><span class=mi>9</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=o>-</span><span class=mi>3</span><span class=p>.</span><span class=mi>1</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=o>-</span><span class=mi>0</span><span class=p>.</span><span class=mi>5</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>(</span><span class=s1>&#39;2019/01/01&#39;</span><span class=p>,</span><span class=s1>&#39;大阪&#39;</span><span class=p>,</span><span class=s1>&#39;大阪&#39;</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;晴後曇&#39;</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>5</span><span class=p>.</span><span class=mi>7</span><span class=w> </span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=w> </span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>10</span><span class=p>.</span><span class=mi>0</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>.</span><span class=mi>5</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>(</span><span class=s1>&#39;2019/01/01&#39;</span><span class=p>,</span><span class=s1>&#39;熊本&#39;</span><span class=p>,</span><span class=s1>&#39;南阿蘇&#39;</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=k>NULL</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>.</span><span class=mi>5</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=o>-</span><span class=mi>3</span><span class=p>.</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=k>NULL</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>4</span><span class=p>.</span><span class=mi>8</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=k>NULL</span><span class=p>,</span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>セレクトクエリ</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>SAMPLE_TBL</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h1 id=バルクロード>バルクロード</h1><p>Snowflake のテーブルへファイルをロードする場合はステージング領域へ PUT し、アップしたファイルを COPY コマンドを用いて取り込む。<br>参考: <a href=https://docs.snowflake.com/ja/user-guide/data-load-local-file-system>https://docs.snowflake.com/ja/user-guide/data-load-local-file-system</a></p><h2 id=内部ステージ経由>内部ステージ経由</h2><p>内部ステージング領域は3種類存在する。</p><ul><li>名前付き</li><li>テーブル</li><li>ユーザー</li></ul><p>テーブルに付属する内部ステージング領域を通して一括ロードを行ってみる。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- ステージング領域へファイルをアップ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>PUT</span><span class=w> </span><span class=s1>&#39;file://data/*.csv&#39;</span><span class=w> </span><span class=s1>&#39;@HELLO_SNOWFLAKE.SAMPLE_SCHEMA.%SAMPLE_TBL&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ステージング領域のファイルを列挙
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>LIST</span><span class=w> </span><span class=s1>&#39;@HELLO_SNOWFLAKE.SAMPLE_SCHEMA.%SAMPLE_TBL&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ステージング領域のファイルを列挙
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>GET</span><span class=w> </span><span class=s1>&#39;@HELLO_SNOWFLAKE.SAMPLE_SCHEMA.%SAMPLE_TBL&#39;</span><span class=w> </span><span class=s1>&#39;file://data_dl/&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ステージング領域のファイルを削除 (1ファイル)
</span></span></span><span class=line><span class=cl><span class=c1>-- REMOVE &#39;@HELLO_SNOWFLAKE.SAMPLE_SCHEMA.%SAMPLE_TBL/{ファイル名}.csv.gz&#39;;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ステージング領域のファイルを削除 (一括)
</span></span></span><span class=line><span class=cl><span class=c1>-- REMOVE &#39;@HELLO_SNOWFLAKE.SAMPLE_SCHEMA.%SAMPLE_TBL&#39;;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ステージング領域のファイルを取り込み
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>COPY</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>SAMPLE_TBL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=o>@</span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=o>%</span><span class=n>SAMPLE_TBL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>FILE_FORMAT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CSV</span><span class=p>,</span><span class=w> </span><span class=n>FIELD_DELIMITER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>,</span><span class=w> </span><span class=n>SKIP_HEADER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PATTERN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;.*.csv.gz&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=外部ステージ経由-s3>外部ステージ経由 (S3)</h2><p>参考: <a href=https://docs.snowflake.com/ja/user-guide/data-load-s3>https://docs.snowflake.com/ja/user-guide/data-load-s3</a></p><p>クラウドストレージ統合</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 事前に Snowflake から S3 へアクセスする事を許可する IAM ロールを作成する。  
</span></span></span><span class=line><span class=cl><span class=c1>-- https://docs.snowflake.com/ja/user-guide/data-load-s3-config-storage-integration
</span></span></span><span class=line><span class=cl><span class=c1>-- 
</span></span></span><span class=line><span class=cl><span class=c1>-- Step.1
</span></span></span><span class=line><span class=cl><span class=c1>-- - Trusted Entity Type: AWS Account
</span></span></span><span class=line><span class=cl><span class=c1>-- - RoleName: {snowflake-sample-s3integration}
</span></span></span><span class=line><span class=cl><span class=c1>-- - Allow
</span></span></span><span class=line><span class=cl><span class=c1>--   - s3:GetBucketLocation
</span></span></span><span class=line><span class=cl><span class=c1>--   - s3:GetObject
</span></span></span><span class=line><span class=cl><span class=c1>--   - s3:GetObjectVersion
</span></span></span><span class=line><span class=cl><span class=c1>--   - s3:ListBucket
</span></span></span><span class=line><span class=cl><span class=c1>--   - s3:PutObject
</span></span></span><span class=line><span class=cl><span class=c1>--   - s3:DeleteObject
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ストレージ統合を作成
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>STORAGE</span><span class=w> </span><span class=n>INTEGRATION</span><span class=w> </span><span class=n>integration_s3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>EXTERNAL_STAGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ENABLED</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>TRUE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>STORAGE_PROVIDER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;S3&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>STORAGE_AWS_ROLE_ARN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;{snowflake-sample-s3integration}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>STORAGE_ALLOWED_LOCATIONS</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;s3://{BUCKETNAME_AND_PREFIX}&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ストレージ統合を列挙
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=k>STORAGE</span><span class=w> </span><span class=n>INTEGRATIONS</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- ストレージ統合を確認
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>DESCRIBE</span><span class=w> </span><span class=n>INTEGRATION</span><span class=w> </span><span class=n>integration_s3</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Step.2: 以下をメモする
</span></span></span><span class=line><span class=cl><span class=c1>-- - STORAGE_AWS_IAM_USER_ARN
</span></span></span><span class=line><span class=cl><span class=c1>-- - STORAGE_AWS_EXTERNAL_ID
</span></span></span><span class=line><span class=cl><span class=c1>-- Step.3: IAM Role {snowflake-sample-s3integration} の信頼関係を修正
</span></span></span><span class=line><span class=cl><span class=c1>-- - Principal.AWS: メモした {STORAGE_AWS_IAM_USER_ARN} を指定
</span></span></span><span class=line><span class=cl><span class=c1>-- - Condition.StringEquals.sts:ExternalId: メモした {STORAGE_AWS_EXTERNAL_ID} を指定
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 外部ステージを作成
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=n>STAGE</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>stage_s3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>STORAGE_INTEGRATION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>integration_s3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>URL</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;s3://{BUCKETNAME_AND_PREFIX}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 外部ステージを列挙
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=n>STAGES</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 外部ステージの中のファイルを列挙
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>LIST</span><span class=w> </span><span class=o>@</span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>stage_s3</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>LIST</span><span class=w> </span><span class=o>@</span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>stage_s3</span><span class=o>/</span><span class=err>{</span><span class=k>PREFIX</span><span class=err>}</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 外部ステージから取り込み
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>COPY</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>SAMPLE_TBL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=s1>&#39;s3://{BUCKETNAME_AND_PREFIX}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>FILE_FORMAT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CSV</span><span class=p>,</span><span class=w> </span><span class=n>FIELD_DELIMITER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>,</span><span class=w> </span><span class=n>SKIP_HEADER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PATTERN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;.*.csv.gz&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h1 id=外部テーブル>外部テーブル</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 外部テーブルを作成
</span></span></span><span class=line><span class=cl><span class=c1>-- 作成後、メタデータの自動更新のために追加作業として SNS を構成する.
</span></span></span><span class=line><span class=cl><span class=c1>-- 参考: https://docs.snowflake.com/ja/user-guide/tables-external-s3#determining-the-correct-option
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=k>EXTERNAL</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>SAMPLE_EXT</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;ymd&#34;</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c1</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;area_1&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c2</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;area_2&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c3</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;天気概況（昼：06時～18時）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c4</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;天気概況（昼：06時～18時）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c5</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;天気概況（昼：06時～18時）計測値&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c6</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;平均気温（℃）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c7</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;平均気温（℃）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c8</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;平均気温（℃）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c9</span><span class=p>::</span><span class=nb>FLOAT</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最低気温（℃）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c10</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最低気温（℃）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c11</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最低気温（℃）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c12</span><span class=p>::</span><span class=nb>FLOAT</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最深積雪（cm）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c13</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最深積雪（cm）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c14</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最深積雪（cm）現象なし情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c15</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最深積雪（cm）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c16</span><span class=p>::</span><span class=nb>FLOAT</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最高気温（℃）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c17</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最高気温（℃）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c18</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;最高気温（℃）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c19</span><span class=p>::</span><span class=nb>FLOAT</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;降水量の合計（mm）品質情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c20</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;降水量の合計（mm）均質番号&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c21</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;降水量の合計（mm）現象なし情報&#34;</span><span class=w> </span><span class=n>STRING</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c22</span><span class=p>::</span><span class=n>STRING</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s2>&#34;降水量の合計（mm）計測値&#34;</span><span class=w> </span><span class=nb>FLOAT</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=n>c23</span><span class=p>::</span><span class=nb>FLOAT</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WITH</span><span class=w> </span><span class=k>LOCATION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>@</span><span class=n>stage_s3</span><span class=o>/</span><span class=err>{</span><span class=k>PREFIX</span><span class=err>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>FILE_FORMAT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CSV</span><span class=p>,</span><span class=w> </span><span class=n>SKIP_HEADER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 外部テーブルの一覧を列挙
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=k>EXTERNAL</span><span class=w> </span><span class=n>TABLES</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- メタデータ更新を手動更新 (自動更新を設定していない場合には必要)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>EXTERNAL</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>HELLO_SNOWFLAKE</span><span class=p>.</span><span class=n>SAMPLE_SCHEMA</span><span class=p>.</span><span class=n>SAMPLE_EXT</span><span class=w> </span><span class=n>REFRESH</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h1 id=ドライバー>ドライバー</h1><p>プログラムからクエリを実行する。</p><h2 id=python>Python</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>snowflake.connector</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># https://docs.snowflake.com/ja/developer-guide/python-connector/python-connector</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>snowflake</span><span class=o>.</span><span class=n>connector</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>user</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>{ユーザ名}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>password</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>{パスワード}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>account</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>{アカウント名}</span><span class=s2>&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>conn</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span> <span class=k>as</span> <span class=n>cur</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>hoge</span> <span class=o>=</span> <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s1>&#39;SELECT &#34;ymd&#34;, &#34;area_1&#34;, &#34;平均気温（℃）計測値&#34; FROM HELLO_SNOWFLAKE.SAMPLE_SCHEMA.SAMPLE_TBL LIMIT 10;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>hoge</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span></code></pre></div><p>レスポンスの有るクエリはタプルとして結果が帰ってくる。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(&#39;2019/1/1&#39;, &#39;石狩&#39;, -1.9)
</span></span><span class=line><span class=cl>(&#39;2019/1/1&#39;, &#39;大阪&#39;, 5.7)
</span></span><span class=line><span class=cl>(&#39;2019/1/1&#39;, &#39;熊本&#39;, 1.5)
</span></span></code></pre></div></section></article></main></div><div><footer id=site-footer class=toplevel-container><p>このサイトでは <a href=https://icons8.jp/>icons8</a> の素材を使用しています。</p><p>&copy; 2024 namoshika, All rights reserved</p></footer></div></div></body></html>