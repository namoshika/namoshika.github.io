<!doctype html><html lang=ja-jp>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="基本操作 サイトを作成する # サイトディレクトリを作成 $ mkdir HelloHugo $ cd HelloHugo # 中を初期化 $ hugo new site # 好みのテーマファイルを取得 (ここでは ananke を指定) $ git submodule add https://github.com/theNewDynamic/gohugo-theme-ananke.git">
<meta name=generator content="Hugo 0.88.1">
<title>Hugo | Memo.Namo</title>
<meta name=robots content="noindex, nofollow">
<link rel=stylesheet href=/style/main.css>
</head>
<body>
<div class=flexbox>
<div>
<header id=site-header class=toplevel-container>
<h1><a href=/>Memo.Namo</a></h1>
<nav>
<ul class=horizontal-menu>
<li class=horizontal-menu-item><a href=/about/>About</a></li>
<li class=horizontal-menu-item><a href=/knowledge/>Knowledge</a></li>
</ul>
</nav>
</header>
<main id=site-main class=toplevel-container>
<article class="content-container content-grid">
<header class=content-grid-header>
<div>
<h1 class=content-grid-title>Hugo</h1>
</div>
<p class=content-grid-desc>
<span>公開日: 2020-08-21</span>
<span>更新日: 2020-08-21</span>
</p>
</header>
<aside class=content-grid-side>
<div class=nav-sticky>
<h2>目次</h2>
<nav id=TableOfContents>
<ul>
<li><a href=#基本操作>基本操作</a>
<ul>
<li><a href=#サイトを作成する>サイトを作成する</a></li>
<li><a href=#記事を作成する>記事を作成する</a></li>
<li><a href=#ディレクトリの構造>ディレクトリの構造</a></li>
<li><a href=#記事のビルド>記事のビルド</a></li>
</ul>
</li>
<li><a href=#コンテンツの管理>コンテンツの管理</a>
<ul>
<li><a href=#ページの種類>ページの種類</a></li>
<li><a href=#ファイルの内容>ファイルの内容</a></li>
<li><a href=#ファイルの雛形>ファイルの雛形</a></li>
<li><a href=#リソースの配置>リソースの配置</a></li>
<li><a href=#ショートコード>ショートコード</a></li>
</ul>
</li>
<li><a href=#テンプレートの導入>テンプレートの導入</a>
<ul>
<li><a href=#描画用テンプレート>描画用テンプレート</a></li>
<li><a href=#描画用テンプレート-partial>描画用テンプレート (Partial)</a></li>
<li><a href=#描画用テンプレート-block>描画用テンプレート (Block))</a></li>
<li><a href=#独自ショートコードの作成>独自ショートコードの作成</a></li>
</ul>
</li>
<li><a href=#テンプレートの活用>テンプレートの活用</a>
<ul>
<li><a href=#値の生成>値の生成</a></li>
<li><a href=#値の出力>値の出力</a></li>
<li><a href=#コンテキスト>コンテキスト</a></li>
<li><a href=#条件分岐>条件分岐</a></li>
<li><a href=#ループ処理>ループ処理</a></li>
<li><a href=#パイプライン>パイプライン</a></li>
<li><a href=#セクション>セクション</a></li>
<li><a href=#アセット処理>アセット処理</a></li>
</ul>
</li>
</ul>
</nav>
<nav class=nav-tag>
<h2>タグ</h2>
<ul class=tag-container>
<li class="tag-item tag-item-inactive">
<a href=/tags/aws/>AWS</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/box/>Box</a>
</li>
<li class="tag-item tag-item-active">
<a href=/tags/hugo/>Hugo</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/nvidia/>Nvidia</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/openssl/>OpenSSL</a>
</li>
<li class="tag-item tag-item-inactive">
<a href=/tags/tableau/>Tableau</a>
</li>
</ul>
</nav>
</div>
</aside>
<section class="md-content content-grid-main"><h1 id=基本操作>基本操作</h1>
<h2 id=サイトを作成する>サイトを作成する</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=c1># サイトディレクトリを作成</span>
$ mkdir HelloHugo
$ <span class=nb>cd</span> HelloHugo

<span class=c1># 中を初期化</span>
$ hugo new site

<span class=c1># 好みのテーマファイルを取得 (ここでは ananke を指定)</span>
$ git submodule add https://github.com/theNewDynamic/gohugo-theme-ananke.git themes/ananke
$ git submodule update --init
$ vim ../config.toml
&gt; ...
&gt; <span class=nv>theme</span> <span class=o>=</span> <span class=s2>&#34;ananke&#34;</span> ... テーマ指定して保存
&gt; ...
</code></pre></div><h2 id=記事を作成する>記事を作成する</h2>
<p>ページは <code>./content/</code> に markdown ファイルとして格納します。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=c1># 新たなページを追加 その1</span>
$ hugo new hello.md
content/hello.md created

<span class=c1># 新たなページを追加 その2</span>
$ hugo new post/article.md
content/post/article.md created

<span class=c1># 動作確認用サーバーを起動 (memo: -D はドラフト版も表示するという意味)</span>
<span class=c1># ブラウザでアクセスして表示を確認 (http://localhost:1313/hello/)</span>
<span class=c1># 表示しながら記事を編集するとホットリロードされ、表示が更新されます。</span>
$ hugo server -D
</code></pre></div><h2 id=ディレクトリの構造>ディレクトリの構造</h2>
<p>各資材は以下の構成になっています。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown>.
├ archetypes       ... 新しいページを追加した際の雛形を格納
│ └ default.md
├ config.toml
├ content          ... ページの格納場所
│ ├ hello.md
│ └ post           ... 各ディレクトリをセクションと呼ぶ。第1階層は ContentType とも呼ぶ
│ 　 └ article.md  ... 先程作成した記事
├ data
├ layouts
├ resources
├ static           ... 静的ファイルの格納場所。ビルド先のルートに展開される
└ themes           ... テーマの格納場所
　 └ ananke        ... インストールしたテーマ
</code></pre></div><h2 id=記事のビルド>記事のビルド</h2>
<p>記事は html 化した上で Web サーバーにホストさせることで公開する。html 化はサブコマンドを指定せず、 <code>hugo</code> コマンドによって行える。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=c1># ./public へ html ファイルを出力</span>
$ hugo
</code></pre></div><h1 id=コンテンツの管理>コンテンツの管理</h1>
<h2 id=ページの種類>ページの種類</h2>
<p>ページを大きく分けると以下の2種類がある。個々の記事は <code>Single Page</code> に属し、 <code>Index Page</code> はセクション下にある <code>Single Page</code> 一覧を表示するページとして使用される。</p>
<table>
<thead>
<tr>
<th style=text-align:left>Type</th>
<th style=text-align:left>Path</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>Single Page</td>
<td style=text-align:left>./content/**/{ArticleName}.md</td>
</tr>
<tr>
<td style=text-align:left>Single Page</td>
<td style=text-align:left>./content/**/{ArticleName}/index.md</td>
</tr>
<tr>
<td style=text-align:left>Index Page</td>
<td style=text-align:left>./content/**/{SectionName}/_index.md</td>
</tr>
</tbody>
</table>
<h2 id=ファイルの内容>ファイルの内容</h2>
<p>ページはメタデータを記述するフロントマター箇所と、本文を記述する markdown の2箇所から成ります。メタデータは YAML として記述 (他形式も対応可能. 既定は YAML.) され、タイトルや分類用のタグ、ドラフト版か否か等を記載できます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;My First Post&#34;</span><span class=w>
</span><span class=w></span><span class=nt>date</span><span class=p>:</span><span class=w> </span><span class=ld>2020-08-03T07:09:35</span><span class=m>+09</span><span class=p>:</span><span class=m>00</span><span class=w>
</span><span class=w></span><span class=nt>tags</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>tag1, tag2]</span><span class=w>
</span><span class=w></span><span class=nt>categories</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>cat1]</span><span class=w>
</span><span class=w></span><span class=nt>draft</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w></span><span class=nt>custom_prop</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>item1, item2, item3]</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w> 
</span><span class=w>
</span><span class=w></span><span class=c># セクション1</span><span class=w>
</span><span class=w></span><span class=l>サンプルテキスト</span><span class=w>
</span></code></pre></div><p>フロントマターの箇所に子セクションの記事へ継承されるプロパティを指定することも可能です (<a href=https://gohugo.io/content-management/front-matter/#front-matter-cascade>Front Matter Cascade</a>)。これは <code>Index Page</code> で配下の <code>Single Page</code> のメタデータを指定する場合に使用できます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;My First Post&#34;</span><span class=w>
</span><span class=w></span><span class=nt>cascade</span><span class=p>:</span><span class=w>
</span><span class=w> </span>- <span class=nt>custom_prop</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>item1, item2, item3]</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span></code></pre></div><h2 id=ファイルの雛形>ファイルの雛形</h2>
<p>新たなページを作成する際、 content 直下のディレクトリ名を Hugo は ContentType として認識します。 ContentType は <code>./archetypes/{ContentType}.md</code> としてタイプごとのページ雛形に使用できる他、 html を生成する際のテンプレート指定の制御で使用可能です。</p>
<p>雛形は以下のような形で定義できます。各タイプに対する雛形はタイプ名の markdown ファイルを作成する事で定義できます。全タイプに対する既定雛形を <code>default.md</code> として定義する事も可能です。</p>
<p>ファイル名</p>
<ul>
<li><code>./content/post/article.md</code> ⇒ <code>./archetypes/post.md</code></li>
<li><code>./content/anyfile</code> ⇒ <code>./archetypes/default.md</code></li>
</ul>
<p>雛形内容</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ replace .Name &#34;</span>-<span class=s2>&#34; &#34;</span><span class=w> </span><span class=s2>&#34; | title }}&#34;</span><span class=w> 
</span><span class=w></span><span class=nt>date</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Date }}</span><span class=w>
</span><span class=w></span><span class=nt>draft</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span><span class=w></span>{{<span class=w> </span><span class=l>expression }} で動的要素を定義可能</span><span class=w>
</span></code></pre></div><h2 id=リソースの配置>リソースの配置</h2>
<p>ページから画像等のリソースを参照したい場合は <code>./static/**/{file}</code> へ格納します。格納するとビルド時に <code>./**/{file}</code> として出力される形で生成ファイルから参照可能です。ただ、ページとの結び付きが強いリソースの場合は static フォルダに置くよりもページと同ディレクトリ以下に置いた方が扱いやすくなります。Hugo ではこれを実現する為にページバンドルの仕組みがあります。</p>
<p>この仕組みを使用する場合はページ名でディレクトリを設置します。記事本体はその中にインデックスファイルとして格納し、関連するリソースはディレクトリ配下に設置する事で使用可能です。ページバンドルは2種類あり、テンプレート (後述) で扱う際に参照可能なリソースの種類や範囲で違いがあるため、用途に応じて使い分ける必要があります。</p>
<table>
<thead>
<tr>
<th style=text-align:left></th>
<th style=text-align:left>Leaf Bundle</th>
<th style=text-align:left>Branch Bundle</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>インデックスファイル</td>
<td style=text-align:left><code>index.md</code></td>
<td style=text-align:left><code>_index.md</code></td>
</tr>
<tr>
<td style=text-align:left>使用可能リソースのタイプ</td>
<td style=text-align:left>制限無し</td>
<td style=text-align:left>ページファイル以外</td>
</tr>
<tr>
<td style=text-align:left>リソースの配置先</td>
<td style=text-align:left>リソースディレクトリの任意の階層</td>
<td style=text-align:left>リソースディレクトリのみ</td>
</tr>
<tr>
<td style=text-align:left>テンプレートタイプ</td>
<td style=text-align:left>single</td>
<td style=text-align:left>list</td>
</tr>
<tr>
<td style=text-align:left>バンドルを入れ子</td>
<td style=text-align:left>不可</td>
<td style=text-align:left>可能</td>
</tr>
<tr>
<td style=text-align:left>非インデックスファイル</td>
<td style=text-align:left>リソースとしてのみ参照可能</td>
<td style=text-align:left>通常ページとしてのみ参照可能</td>
</tr>
</tbody>
</table>
<p>Leaf と Branch の例を以下に記載します。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback># Leaf Bundle
content/posts/my-post
┣ content/posts/my-post/index.md ... index file
┣ subdir
┃ ┗ image1.jpg ... リソース(テンプレート内からの参照時: .Resource.Match &#34;/subdir/image1.jpg&#34;)
┣ image2.jpg   ... リソース(テンプレート内からの参照時: .Resource.Match &#34;/subdir/image2.jpg&#34;)
┗ page.md      ... リソース(テンプレート内からの参照時: .Resource.Match &#34;/page.md&#34;)

# Branch Bundle
content/posts/my-post
┣ content/posts/my-post/_index.md ... index file
┣ subdir
┃ ┗ image1.jpg ... リソース(テンプレート内からの参照時: .Resource.Match &#34;/subdir/image1.jpg&#34;)
┣ image2.jpg   ... リソース(テンプレート内からの参照時: .Resource.Match &#34;/subdir/image2.jpg&#34;)
┗ page.md      ... ページ (テンプレート内からの参照時: .GetPage &#34;/page.md&#34;)
</code></pre></div><h2 id=ショートコード>ショートコード</h2>
<p>埋め込みコンテンツなどの html を書き込む必要のあるコンテンツは markdown 上では書き込めません (html タグは HUGO によって無効化される)。代わりにいくつかの web サービスの埋込みにはショートコードの仕組みが提供されています。また、ショートコードはテンプレート機能を用いる事で自作も可能です。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown>YouTube 動画の貼付け可能。ショートコードという機能を活用する
{{<span class=p>&lt;</span> <span class=nt>youtube</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;OP6NxM6Al98&#34;</span> <span class=p>&gt;</span>}}

ショートコードは独自のものも作成可能
{{<span class=p>&lt;</span> <span class=nt>hogeshort</span> <span class=na>color </span><span class=o>=</span> <span class=s>&#34;blue&#34;</span> <span class=p>&gt;</span>}}
</code></pre></div><h1 id=テンプレートの導入>テンプレートの導入</h1>
<h2 id=描画用テンプレート>描画用テンプレート</h2>
<p>HUGO は保有するページを <code>./layouts/</code> にあるテンプレートを使用し描画します。 ページの html 化は Go の Template 機能によって実装されており、テンプレートファイル内では <code>{{expression}}</code> を仕込むことで動的要素を仕込めます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- 動的要素の展開 --&gt;</span>
<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>{{ expression }}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</code></pre></div><p>各ページの描画に使用されるテンプレートは <code>./layout/{type or kind}/{layout}.html</code> という形で決定されます。<code>type</code> や <code>kind</code> 、 <code>layout</code> は ./content 下のページのパスから暗黙的に指定されるほか、各ページのフロントマターで明示する事も可能です。 <code>type</code> は ContentType とも呼ばれ、フロントマターで未指定の場合には ./content 直下のディレクトリ名が使用されます。</p>
<p>テンプレートのファイルパスは複数種類が使用可能です。ページパスからの暗黙指定ルールを表形式で記載すると以下のようになります。表中の kind, type では type が優先され、適合するテンプレートが無い場合には <code>_default</code> のディレクトリが参照されます。各項目内の複数ワードは先頭ほど優先されて使用されます。</p>
<p>一部の仕様 (2重拡張子の箇所) は記載を割愛してます。詳しくは本家資料を参照してください。<br>
<strong>Hugo&rsquo;s Lookup Order</strong> (<a href=https://gohugo.io/templates/lookup-order/>https://gohugo.io/templates/lookup-order/</a>)</p>
<table>
<thead>
<tr>
<th style=text-align:left>path</th>
<th style=text-align:left>kind</th>
<th style=text-align:left>type *2</th>
<th style=text-align:left>layout *2</th>
<th style=text-align:left>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>/_index.md</td>
<td style=text-align:left>home *1</td>
<td style=text-align:left>-</td>
<td style=text-align:left>index, home, list</td>
<td style=text-align:left>トップページ</td>
</tr>
<tr>
<td style=text-align:left>/something.md</td>
<td style=text-align:left>page</td>
<td style=text-align:left>-</td>
<td style=text-align:left>single</td>
<td style=text-align:left>通常ページ</td>
</tr>
<tr>
<td style=text-align:left>/{type}/**/_index.md</td>
<td style=text-align:left>section</td>
<td style=text-align:left>{type}</td>
<td style=text-align:left>{type}, section, list</td>
<td style=text-align:left>セクション内の目次ページ</td>
</tr>
<tr>
<td style=text-align:left>/{type}/**/something.md</td>
<td style=text-align:left>page</td>
<td style=text-align:left>{type}</td>
<td style=text-align:left>single</td>
<td style=text-align:left>通常ページ</td>
</tr>
<tr>
<td style=text-align:left>(/{taxonomy})</td>
<td style=text-align:left>taxonomy</td>
<td style=text-align:left>{taxonomy}s, {taxonomy}</td>
<td style=text-align:left>{taxonomy}.terms, terms, taxonomy, list</td>
<td style=text-align:left>タグ一覧ページ</td>
</tr>
<tr>
<td style=text-align:left>(/{taxonomy}/{term})</td>
<td style=text-align:left>term</td>
<td style=text-align:left>{taxonomy}s, term, taxonomy, {taxonomy}</td>
<td style=text-align:left>term, {tag_name}, taxonomy, list</td>
<td style=text-align:left>個々のタグの記事一覧ページ</td>
</tr>
</tbody>
</table>
<p>※1 パス的には空相当<br>
※2 優先度の高い順に記載</p>
<h2 id=描画用テンプレート-partial>描画用テンプレート (Partial)</h2>
<p>部品化し、独立したファイルにする事も可能です。その場合は ./layouts/partials へ配置して使います。テンプレートへの引数はカレントコンテキストを渡すのに使用される為、オプション指定は .Scratch をまたいで行います。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- layouts/partials/subtemp.html を作成したとする --&gt;</span>
<span class=c>&lt;!-- .Scratch.Get で値を取得する --&gt;</span>
<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Partial template body {{.Page.Date}}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>{{ $param := .Scratch.Get &#34;Param1&#34;}}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- パーシャルテンプレートを使う場合は partial 関数を使う --&gt;</span>
<span class=c>&lt;!-- .Scratch.Set を使って値を入れる --&gt;</span>
<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>{{ $param := .Scratch.Set &#34;Param1&#34; &#34;Value&#34; }}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
{{ partial &#34;subtemp&#34; . }}
</code></pre></div><h2 id=描画用テンプレート-block>描画用テンプレート (Block))</h2>
<p>block はページの外枠を定義する機構を提供します。 partial との違いは partial が呼び出し元テンプレートの中へ別ファイルとして定義したテンプレートを埋め込みますが、 block は別ファイルとして定義したテンプレートへ呼び出し元のテンプレートが埋め込まれる挙動をします。</p>
<p>使用する際はベーステンプレートとして <code>baseof.html</code> を作成し、内部には <code>block "名前" .</code> を定義しておきます。各テンプレート内では <code>define "名前"</code> を定義して使う事で、 <code>baseof.html</code> をベースに <code>block "名前" .</code> へ <code>define "名前"</code> を入れた状態で描画されます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- テンプレート呼び出し --&gt;</span>
<span class=c>&lt;!-- 第2引数で指定したものがテンプレート内でのカレントコンテキストになる --&gt;</span>
{{ define &#34;subtemp&#34; }}
    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>テンプレート内容をここへ定義する<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
{{ end }}
</code></pre></div><p>以下のファイルを <code>./layouts/_default/baseof.html</code> として作成</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=c>&lt;!-- baseof.html 内部では block でサブテンプレートを参照する --&gt;</span>
{{ block &#34;subtemp&#34; . }}
    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>テンプレートが存在しなかった場合には、ここの定義が使用される<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
{{ end }}
</code></pre></div><h2 id=独自ショートコードの作成>独自ショートコードの作成</h2>
<p><code>./layouts/shortcodes</code> 内で作成したテンプレートは markdown から呼び出せます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=c1># ショートコードは Go の Template 形式で記述する</span>
vim layouts/shortcodes/shortcode-name.html

<span class=c1># markdown ファイル内の使用したい箇所に以下を記述</span>
<span class=c1># 起動時のオプションも attr=&#34;value&#34; の形式で記述可能</span>
<span class=o>{{</span>&lt;shortcode-name <span class=nv>attr_name</span><span class=o>=</span><span class=s2>&#34;value&#34;</span> &gt;<span class=o>}}</span>
</code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span><span class=cm>/* ショートコード使用時のオプションは以下の記述で取得可能 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=p>.</span><span class=nx>Get</span> <span class=s>&#34;attr_name&#34;</span> <span class=p>}}</span>
<span class=p>{{</span><span class=cm>/* 未指定時に既定値を使用 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=p>.</span><span class=nx>Get</span> <span class=s>&#34;attr_name&#34;</span> <span class=p>|</span> <span class=k>default</span> <span class=s>&#34;default value&#34;</span> <span class=p>}}</span>
<span class=p>{{</span><span class=cm>/* 未指定時にスコープ内の処理をスキップ */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=nx>with</span> <span class=p>.</span><span class=nx>Get</span> <span class=s>&#34;attr_name&#34;</span> <span class=p>}}{{</span> <span class=p>.</span> <span class=p>}}{{</span> <span class=nx>end</span> <span class=p>}}</span>
</code></pre></div><h1 id=テンプレートの活用>テンプレートの活用</h1>
<p>テンプレートは go 標準の text/template で記述します。</p>
<h2 id=値の生成>値の生成</h2>
<p>配列やマップオブジェクトを定義する際は以下の通り。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span><span class=cm>/* 値の代入・参照 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>var_name</span> <span class=o>:=</span> <span class=nx>expression</span> <span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>var_name</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* 配列の生成 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=nx>slice</span> <span class=mi>100</span> <span class=mi>200</span> <span class=mi>300</span> <span class=p>}}</span>
<span class=p>{{</span><span class=cm>/* 配列の生成 (シーケンス) */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=nx>seq</span> <span class=mi>1</span> <span class=mi>5</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* マップオブジェクトの生成 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=nx>dict</span> <span class=s>&#34;key1&#34;</span> <span class=mi>100</span> <span class=s>&#34;key2&#34;</span> <span class=mi>200</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* ネスト */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>var_name</span> <span class=o>:=</span> <span class=nx>dict</span> <span class=s>&#34;key1&#34;</span> <span class=mi>100</span> <span class=s>&#34;key2&#34;</span> <span class=p>(</span><span class=nx>slice</span> <span class=mi>200</span> <span class=mi>300</span> <span class=mi>400</span><span class=p>)</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* 配列・マップオブジェクトの対象要素へのアクセス */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=nx>index</span> <span class=err>$</span><span class=nx>var_name</span> <span class=s>&#34;key2&#34;</span> <span class=mi>1</span> <span class=p>}}</span>
</code></pre></div><h2 id=値の出力>値の出力</h2>
<p>文字列の結合などを行う場合は <code>printf</code> を使います。文字列の結合演算子などはありません。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span> <span class=err>$</span><span class=nx>val</span> <span class=p>=</span> <span class=p>.</span> <span class=p>}}</span>
<span class=p>{{</span> <span class=nx>printf</span> <span class=s>&#34;value: %s, type_info: %T&#34;</span> <span class=err>$</span><span class=nx>val</span> <span class=err>$</span><span class=nx>val</span> <span class=p>}}</span>
</code></pre></div><h2 id=コンテキスト>コンテキスト</h2>
<p>テンプレートは実行される際にコンテキストを持ちます。コンテキストは <code>"."</code> で参照でき、大抵のテンプレートは描画中の Page オブジェクトをコンテキストに起動します。Page オブジェクトからはページのタイトルやURL、親ページなどを取得できます。</p>
<p>また、<code>$.</code> を使うとグローバルコンテキストを参照できます。これは for 句などで <code>"."</code> から参照できるコンテキストが変化した状態で Page オブジェクトを参照しようとした際に使用できます。</p>
<p>参照可能な変数に関する詳細は本家資料を参照してください。<br>
<strong>Variables and Params</strong> (<a href=https://gohugo.io/variables/>https://gohugo.io/variables/</a>)</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span><span class=cm>/* 描画中のページのタイトルを取得 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>title</span> <span class=o>:=</span> <span class=p>.</span><span class=nx>Title</span> <span class=p>}}</span>
<span class=p>{{</span><span class=cm>/* 描画中のページのタイトルを取得 ($を使うとグローバルコンテキストを参照する) */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>title</span> <span class=o>:=</span> <span class=err>$</span><span class=p>.</span><span class=nx>Title</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* 親ページのオブジェクトを取得 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>parent_page_obj</span> <span class=o>:=</span> <span class=p>.</span><span class=nx>Parent</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* 任意のページのオブジェクトを取得 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>other_page_obj</span> <span class=o>:=</span> <span class=p>.</span><span class=nx>GetPage</span> <span class=s>&#34;/other&#34;</span> <span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>other_page_url</span> <span class=o>:=</span> <span class=err>$</span><span class=nx>other_page_obj</span><span class=p>.</span><span class=nx>RelPermalink</span> <span class=p>}}</span>
</code></pre></div><h2 id=条件分岐>条件分岐</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span><span class=cm>/* 条件分岐 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>val</span> <span class=o>:=</span> <span class=mi>2</span> <span class=p>}}</span>
<span class=p>{{</span> <span class=k>if</span> <span class=nx>eq</span> <span class=err>$</span><span class=nx>val</span> <span class=mi>1</span> <span class=p>}}</span>
    <span class=p>&lt;</span><span class=nx>p</span><span class=p>&gt;</span><span class=nx>テキストA</span><span class=p>&lt;</span><span class=o>/</span><span class=nx>p</span><span class=p>&gt;</span>
<span class=p>{{</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>eq</span> <span class=err>$</span><span class=nx>val</span> <span class=mi>2</span> <span class=p>}}</span>
    <span class=p>&lt;</span><span class=nx>p</span><span class=p>&gt;</span><span class=nx>テキストB</span><span class=p>&lt;</span><span class=o>/</span><span class=nx>p</span><span class=p>&gt;</span>
<span class=p>{{</span> <span class=k>else</span> <span class=p>}}</span>
    <span class=p>&lt;</span><span class=nx>p</span><span class=p>&gt;</span><span class=nx>テキストC</span><span class=p>&lt;</span><span class=o>/</span><span class=nx>p</span><span class=p>&gt;</span>
<span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* 演算子 */</span><span class=p>}}</span>
<span class=p>{{</span><span class=cm>/* シェルスクリプト風だが、演算子ではなく関数として実装されている */</span><span class=p>}}</span>
<span class=p>{{</span><span class=o>-</span> <span class=nx>eq</span> <span class=s>&#34;text_a&#34;</span> <span class=s>&#34;text_a&#34;</span> <span class=o>-</span><span class=p>}}</span> <span class=p>{{</span><span class=cm>/* == ... true  */</span><span class=p>}}</span>
<span class=p>{{</span><span class=o>-</span> <span class=nx>ne</span> <span class=s>&#34;text_a&#34;</span> <span class=s>&#34;text_a&#34;</span> <span class=o>-</span><span class=p>}}</span> <span class=p>{{</span><span class=cm>/* != ... false */</span><span class=p>}}</span>
<span class=p>{{</span><span class=o>-</span> <span class=nx>not</span> <span class=mi>100</span> <span class=mi>200</span> <span class=o>-</span><span class=p>}}</span>          <span class=p>{{</span><span class=cm>/* !  ... false */</span><span class=p>}}</span>
<span class=p>{{</span><span class=o>-</span> <span class=nx>lt</span> <span class=mi>100</span> <span class=mi>200</span> <span class=o>-</span><span class=p>}}</span>           <span class=p>{{</span><span class=cm>/* &lt;  ... true  */</span><span class=p>}}</span>
<span class=p>{{</span><span class=o>-</span> <span class=nx>le</span> <span class=mi>100</span> <span class=mi>200</span> <span class=o>-</span><span class=p>}}</span>           <span class=p>{{</span><span class=cm>/* &lt;= ... true  */</span><span class=p>}}</span>
<span class=p>{{</span><span class=o>-</span> <span class=nx>gt</span> <span class=mi>100</span> <span class=mi>200</span> <span class=o>-</span><span class=p>}}</span>           <span class=p>{{</span><span class=cm>/* &gt;  ... false */</span><span class=p>}}</span>
<span class=p>{{</span><span class=o>-</span> <span class=nx>ge</span> <span class=mi>100</span> <span class=mi>200</span> <span class=o>-</span><span class=p>}}</span>           <span class=p>{{</span><span class=cm>/* &gt;= ... false */</span><span class=p>}}</span>
</code></pre></div><h2 id=ループ処理>ループ処理</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span><span class=cm>/* ループ1 (ループ内はカレントコンテキストが列挙中の要素になる) */</span><span class=p>}}</span>
<span class=p>{{</span><span class=cm>/* 元のコンテキストを参照したい場合には . と書く */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=k>range</span> <span class=nx>slice</span> <span class=s>&#34;text_a&#34;</span> <span class=s>&#34;text_b&#34;</span> <span class=s>&#34;text_c&#34;</span> <span class=p>}}</span>
    <span class=p>&lt;</span><span class=nx>li</span><span class=p>&gt;{{.}}</span> <span class=p>{{</span> <span class=err>$</span><span class=p>.</span><span class=nx>Page</span><span class=p>.</span><span class=nx>Title</span> <span class=p>}}&lt;</span><span class=o>/</span><span class=nx>li</span><span class=p>&gt;</span>
<span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* ループ1 (変数指定すると添字も取得できる。 */</span><span class=p>}}</span>
<span class=p>{{</span><span class=cm>/* しかし、変数指定してもカレントコンテキストは切り替わる) */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=k>range</span> <span class=err>$</span><span class=nx>idx</span><span class=p>,</span> <span class=err>$</span><span class=nx>item</span> <span class=o>:=</span> <span class=nx>slice</span> <span class=s>&#34;text_a&#34;</span> <span class=s>&#34;text_b&#34;</span> <span class=s>&#34;text_c&#34;</span> <span class=p>}}</span>
    <span class=p>&lt;</span><span class=nx>li</span><span class=p>&gt;{{</span> <span class=err>$</span><span class=nx>idx</span> <span class=p>}}:</span> <span class=p>{{</span> <span class=err>$</span><span class=nx>item</span> <span class=p>}}&lt;</span><span class=o>/</span><span class=nx>li</span><span class=p>&gt;</span>
<span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span>
</code></pre></div><h2 id=パイプライン>パイプライン</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span><span class=cm>/* パイプ文字で複数関数を繋ぐと、実行結果を左から右へ流せる */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=nx>seq</span> <span class=mi>1</span> <span class=mi>5</span> <span class=p>|</span> <span class=nx>shuffle</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* 複数引数の関数へも使用可能。関数はカリー化されている様子 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=s>&#34;isn&#39;t it?&#34;</span> <span class=p>|</span> <span class=nx>printf</span> <span class=s>&#34;This is a %s, %s&#34;</span> <span class=s>&#34;pen&#34;</span> <span class=p>}}</span>
</code></pre></div><h2 id=セクション>セクション</h2>
<p><code>./content</code> の記事をディレクトリで整理した場合、ディレクトリは HUGO 上ではセクションとして認識され、各セクションを Page オブジェクトとして扱えます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span> <span class=p>.</span><span class=nx>CurrentSection</span> <span class=p>}}</span> <span class=o>...</span> <span class=nx>現在地のセクション</span>
<span class=p>{{</span> <span class=p>.</span><span class=nx>Parent</span> <span class=p>}}</span> <span class=o>...</span> <span class=nx>親セクション</span>
<span class=p>{{</span> <span class=p>.</span><span class=nx>Sections</span> <span class=p>}}</span> <span class=o>...</span> <span class=nx>現在地にぶら下がるサブセクション</span>
</code></pre></div><h2 id=アセット処理>アセット処理</h2>
<p><code>./assets</code> に格納されたリソースは、テンプレートで使用する前に何かしらの処理を加えるといったことが可能です。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=p>{{</span><span class=cm>/* asset/style からCSSファイルを2本取得 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>css_1</span> <span class=o>:=</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Get</span> <span class=s>&#34;style/1.css&#34;</span> <span class=p>|</span>  <span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>css_2</span> <span class=o>:=</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Get</span> <span class=s>&#34;style/2.css&#34;</span> <span class=p>|</span>  <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* CSSファイル2本を結合し、新たなファイル名を main.css と命名 */</span><span class=p>}}</span>
<span class=p>{{</span> <span class=err>$</span><span class=nx>css_file</span> <span class=o>:=</span> <span class=nx>slice</span> <span class=err>$</span><span class=nx>css_1</span> <span class=err>$</span><span class=nx>css_2</span> <span class=p>|</span> <span class=nx>resources</span><span class=p>.</span><span class=nx>Concat</span> <span class=s>&#34;style/main.css&#34;</span> <span class=p>}}</span>

<span class=p>{{</span><span class=cm>/* RelPermalink などで処理結果を使用可能 */</span><span class=p>}}</span>
<span class=p>&lt;</span><span class=nx>link</span> <span class=nx>rel</span><span class=p>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=nx>href</span><span class=p>=</span><span class=s>&#34;{{ $css_file.RelPermalink }}&#34;</span><span class=p>&gt;</span>
</code></pre></div></section>
</article>
</main>
</div>
<div>
<footer id=site-footer class=toplevel-container>
<p>このサイトでは <a href=https://icons8.jp/>icons8</a> の素材を使用しています。</p>
<p>&copy; 2021 namoshika, All rights reserved</p>
</footer>
</div>
</div>
</body>
</html>